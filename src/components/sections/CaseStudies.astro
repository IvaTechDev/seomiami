---
/**
 * Case Studies Section Component
 * Displays success stories with before/after data and metrics
 */

import Section from '../ui/Section.astro';
import Container from '../ui/Container.astro';
import Heading from '../ui/Heading.astro';
import Card from '../ui/Card.astro';
import Badge from '../ui/Badge.astro';
import Button from '../ui/Button.astro';
import { MapPin, TrendingUp, DollarSign, Award, ArrowRight } from 'lucide-react';
import BeforeAfter from '../interactive/BeforeAfter.tsx';
import { caseStudies } from '../../data/case-studies';

// Get the first 3 case studies
const featuredCaseStudies = caseStudies.slice(0, 3);
---

<Section id="case-studies">
  <Container>
    <div class="text-center mb-16">
      <Heading level="h2" as="h2" className="mb-4">
        Real Miami Businesses. <span class="text-miami-cyan">Real Results.</span>
      </Heading>
      <p class="text-xl text-slate-300 max-w-3xl mx-auto">
        See how we've helped local businesses dominate their markets
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {featuredCaseStudies.map((study, index) => (
        <Card 
          variant="glass"
          className="flex flex-col h-full hover:scale-105 transition-transform duration-300"
        >
          {/* Header with industry badge */}
          <div class="mb-6">
            <Badge variant="outline" className="mb-3">
              {study.industry}
            </Badge>
            <h3 class="text-2xl font-display font-bold text-white mb-2">
              {study.clientName}
            </h3>
            <p class="text-sm text-slate-400 flex items-center gap-2">
              <MapPin size="36" />
              {study.location}
            </p>
          </div>

          {/* Key Metrics */}
          <div class="space-y-4 mb-6 flex-grow">
            <div class="grid grid-cols-2 gap-4">
              {/* Traffic Increase */}
              <div class="bg-miami-navy/50 rounded-lg p-4 border border-miami-cyan/20">
                <div class="flex items-center gap-2 mb-2">
                  <TrendingUp size="24" className="text-miami-cyan" />
                  <span class="text-xs text-slate-400 uppercase tracking-wide">Traffic</span>
                </div>
                <p class="text-2xl font-bold text-miami-cyan">
                  {`+${study.improvements.trafficIncrease}%`}
                </p>
              </div>

              {/* Revenue Increase */}
              <div class="bg-miami-navy/50 rounded-lg p-4 border border-miami-purple/20">
                <div class="flex items-center gap-2 mb-2">
                  <DollarSign size="24" className="text-miami-purple" />
                  <span class="text-xs text-slate-400 uppercase tracking-wide">Revenue</span>
                </div>
                <p class="text-2xl font-bold text-miami-purple">
                  {`+${study.improvements.revenueIncrease}%`}
                </p>
              </div>
            </div>

            {/* Ranking Improvement */}
            <div class="bg-gradient-to-r from-miami-cyan/10 to-miami-purple/10 rounded-lg p-4 border border-miami-cyan/20">
              <div class="flex items-center gap-2 mb-2">
                <Award size="36" className="text-miami-pink" />
                <span class="text-xs text-slate-400 uppercase tracking-wide">Ranking</span>
              </div>
              <p class="text-lg font-semibold text-white">
                {`${study.before.ranking} â†’ ${study.after.ranking}`}
              </p>
              <p class="text-sm text-miami-cyan mt-1">
                {study.improvements.rankingChange}
              </p>
            </div>

            {/* Timeframe */}
            <div class="text-center text-sm text-slate-400">
              Achieved in <span class="text-white font-semibold">{study.timeframe}</span>
            </div>
          </div>

          {/* Before/After Component - only for first case study */}
          {/*index === 0 && (
            <div class="mb-6">
              <BeforeAfter
                client:visible
                caseStudy={study}
              />
            </div>
          )*/}

          {/* CTA */}
          <div class="mt-auto">
            <Button 
              href={`#case-study-${study.id}`} 
              variant="ghost"
              size="md"
              className="w-full group"
            >
              View Full Case Study
              <ArrowRight size="24" className="group-hover:translate-x-1 transition-transform" />
            </Button>
          </div>
        </Card>
      ))}
    </div>

    {/* Summary Stats */}
    <div class="mt-16 grid grid-cols-1 md:grid-cols-3 gap-8">
      <div class="text-center">
        <div class="text-5xl font-display font-bold text-transparent bg-clip-text bg-gradient-to-r from-miami-cyan to-miami-purple mb-2">
          500+
        </div>
        <p class="text-slate-300">Businesses Helped</p>
      </div>
      <div class="text-center">
        <div class="text-5xl font-display font-bold text-transparent bg-clip-text bg-gradient-to-r from-miami-purple to-miami-pink mb-2">
          275%
        </div>
        <p class="text-slate-300">Average Traffic Increase</p>
      </div>
      <div class="text-center">
        <div class="text-5xl font-display font-bold text-transparent bg-clip-text bg-gradient-to-r from-miami-pink to-miami-cyan mb-2">
          #1
        </div>
        <p class="text-slate-300">Rankings Achieved</p>
      </div>
    </div>
  </Container>
</Section>

<style>
  /* Scroll reveal animation */
  @media (prefers-reduced-motion: no-preference) {
    [data-aos] {
      opacity: 0;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    [data-aos].aos-animate {
      opacity: 1;
      transform: none;
    }
  }
</style>
